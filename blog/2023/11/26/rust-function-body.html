<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Formal Land RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Formal Land Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-MQLHF4EV4J"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-MQLHF4EV4J",{anonymize_ip:!0})</script><title data-react-helmet="true">Translation of function bodies from Rust to Coq | Formal Land</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://formal.land/img/land-512.png"><meta data-react-helmet="true" name="twitter:image" content="https://formal.land/img/land-512.png"><meta data-react-helmet="true" property="og:url" content="https://formal.land/blog/2023/11/26/rust-function-body"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="Translation of function bodies from Rust to Coq | Formal Land"><meta data-react-helmet="true" name="description" content="Our tool coq-of-rust enables formal verification of ü¶Ä&amp;nbsp;Rust code, to make sure that a program has no bugs given a precise specification. We work by translating Rust programs to the general proof system üêì&amp;nbsp;Coq."><meta data-react-helmet="true" property="og:description" content="Our tool coq-of-rust enables formal verification of ü¶Ä&amp;nbsp;Rust code, to make sure that a program has no bugs given a precise specification. We work by translating Rust programs to the general proof system üêì&amp;nbsp;Coq."><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2023-11-26T00:00:00.000Z"><meta data-react-helmet="true" property="article:tag" content="coq-of-rust,Rust,Coq"><link data-react-helmet="true" rel="icon" href="/img/land-512.png"><link data-react-helmet="true" rel="canonical" href="https://formal.land/blog/2023/11/26/rust-function-body"><link data-react-helmet="true" rel="alternate" href="https://formal.land/blog/2023/11/26/rust-function-body" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://formal.land/blog/2023/11/26/rust-function-body" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.20dc303f.css">
<link rel="preload" href="/assets/js/runtime~main.182d6f7c.js" as="script">
<link rel="preload" href="/assets/js/main.d84506b2.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><div class="announcementBar_3WsW" style="background-color:#fafbfc;color:#091E42" role="banner"><div class="announcementBarContent_3EUC">For formal verification services, email us at <a href="mailto:&#099;&#111;&#110;&#116;&#097;&#099;&#116;&#064;formal&#046;&#108;&#097;&#110;&#100;">&#099;&#111;&#110;&#116;&#097;&#099;&#116;&#064;formal&#046;&#108;&#097;&#110;&#100;</a>! (Rust, OCaml)</div></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/land-512.png" alt="Logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/land-512.png" alt="Logo" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">Formal Land</b></a><a class="navbar__item navbar__link" href="/docs/company/about">Company</a><a class="navbar__item navbar__link" href="/docs/verification/ocaml">Formal verification</a><a class="navbar__item navbar__link" href="/docs/services/solidity-development">Services</a><a class="navbar__item navbar__link" href="/docs/coq-of-ocaml/introduction">coq-of-ocaml</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/formal-land" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://gitlab.com/formal-land" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitLab<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_2ahu thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_2hhb margin-bottom--md">Recent posts</div><ul class="sidebarItemList_2xAf"><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2024/01/18/update-coq-of-rust">Upgrade the Rust version of coq-of-rust</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2024/01/04/rust-translating-match">Translating Rust match patterns to Coq with coq-of-rust</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2023/12/13/rust-verify-erc-20-smart-contract">Verifying an ERC-20 smart contract in Rust</a></li><li class="sidebarItem_2UVv"><a aria-current="page" class="sidebarItemLink_1RT6 sidebarItemLinkActive_12pM" href="/blog/2023/11/26/rust-function-body">Translation of function bodies from Rust to Coq</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2023/11/08/rust-thir-and-bundled-traits">Optimizing Rust translation to Coq with THIR and bundled traits</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_GeHD" itemprop="headline">Translation of function bodies from Rust to Coq</h1><div class="blogPostData_291c margin-vert--md"><time datetime="2023-11-26T00:00:00.000Z" itemprop="datePublished">November 26, 2023</time> ¬∑ <!-- -->5 min read</div></header><div class="markdown" itemprop="articleBody"><p>Our tool <a href="https://github.com/formal-land/coq-of-rust" target="_blank" rel="noopener noreferrer">coq-of-rust</a> enables formal verification of <a href="https://www.rust-lang.org/" target="_blank" rel="noopener noreferrer">ü¶Ä<!-- -->¬†<!-- -->Rust</a> code, to make sure that a program has no bugs given a precise specification. We work by translating Rust programs to the general proof system <a href="https://coq.inria.fr/" target="_blank" rel="noopener noreferrer">üêì<!-- -->¬†<!-- -->Coq</a>.</p><p>Here, we present how we translate function bodies from Rust to Coq in an example. We also show some of the optimizations we made to reduce the size of the translation.</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Purchase</h5></div><div class="admonition-content"><p>If you need to formally verify your Rust codebase to improve the security of your application, email us at<!-- -->¬†<a href="mailto:contact@formal.land" target="_blank" rel="noopener noreferrer">c<!-- -->o<!-- -->n<!-- -->t<!-- -->a<!-- -->c<!-- -->t<!-- -->@<!-- -->formal<!-- -->.<!-- -->l<!-- -->a<!-- -->n<!-- -->d</a>!</p></div></div><p><img alt="Rust and Coq" src="/assets/images/rust_and_coq-e644a4a1dfd171b8b97366213a50a080.png"></p><h2 class="anchor anchorWithStickyNavbar_31ik" id="translating-a-function-body">Translating a function body<a class="hash-link" href="#translating-a-function-body" title="Direct link to heading">‚Äã</a></h2><p>We take the following Rust example as input:</p><div class="codeBlockContainer_K1bP language-rust theme-code-block"><div class="codeBlockContent_hGly rust"><pre tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">// fn balance_of_impl(&amp;self, owner: &amp;AccountId) -&gt; Balance { ... }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn balance_of(&amp;self, owner: AccountId) -&gt; Balance {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    self.balance_of_impl(&amp;owner)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Here is the corresponding Coq code that <code>coq-of-rust</code> generates <em>without optimizations</em>:</p><div class="codeBlockContainer_K1bP language-coq theme-code-block"><div class="codeBlockContent_hGly coq"><pre tabindex="0" class="prism-code language-coq codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">Definition balance_of</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (self : ref ltac:(Self))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (owner : erc20.AccountId.t)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    : M ltac:(erc20.Balance) :=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* self : M.Val (ref ltac:(Self)) := M.alloc self in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* owner : M.Val erc20.AccountId.t := M.alloc owner in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* Œ±0 : ref erc20.Erc20.t := M.read self in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* Œ±1 : M.Val erc20.Erc20.t := deref Œ±0 in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* Œ±2 : ref erc20.Erc20.t := borrow Œ±1 in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* Œ±3 : M.Val (ref erc20.Erc20.t) := M.alloc Œ±2 in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* Œ±4 : ref erc20.Erc20.t := M.read Œ±3 in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* Œ±5 : ref erc20.AccountId.t := borrow owner in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* Œ±6 : M.Val (ref erc20.AccountId.t) := M.alloc Œ±5 in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* Œ±7 : ref erc20.AccountId.t := M.read Œ±6 in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* Œ±8 : M.Val erc20.AccountId.t := deref Œ±7 in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* Œ±9 : ref erc20.AccountId.t := borrow Œ±8 in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* Œ±10 : M.Val (ref erc20.AccountId.t) := M.alloc Œ±9 in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* Œ±11 : ref erc20.AccountId.t := M.read Œ±10 in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* Œ±12 : u128.t := erc20.Erc20.t::[&quot;balance_of_impl&quot;] Œ±4 Œ±11 in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* Œ±13 : M.Val u128.t := M.alloc Œ±12 in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  M.read Œ±13.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This code is much more verbose than the original Rust code as we make all pointer manipulations explicit. We will see just after how to simplify it. We start with the function declaration:</p><div class="codeBlockContainer_K1bP language-coq theme-code-block"><div class="codeBlockContent_hGly coq"><pre tabindex="0" class="prism-code language-coq codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">Definition balance_of</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (self : ref ltac:(Self))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (owner : erc20.AccountId.t)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    : M ltac:(erc20.Balance) :=</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>that repeats the parameters in the Rust source. Note that the final result is wrapped into the monad type <code>M</code>. This is a monad representing all the side-effects used in Rust programs (state, panic, non-termination, ...). Then, we allocate all the function parameters:</p><div class="codeBlockContainer_K1bP language-coq theme-code-block"><div class="codeBlockContent_hGly coq"><pre tabindex="0" class="prism-code language-coq codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">  let* self : M.Val (ref ltac:(Self)) := M.alloc self in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* owner : M.Val erc20.AccountId.t := M.alloc owner in</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This ensures that both <code>self</code> and <code>owner</code> have an address in memory, in case we borrow them later. This allocation is also fresh, so we cannot access the address of the values from the caller by mistake. We use the monadic let <code>let*</code> as allocations can modify the memory state.</p><p>Then we start by the body of the function itself. We do all the necessary pointer manipulations to compute the parameters <code>self</code> and <code>&amp;owner</code> of the function <code>balance_of_impl</code>. These representations are directly taken from the abstract syntax tree of the Rust compiler (using the <a href="https://rustc-dev-guide.rust-lang.org/thir.html" target="_blank" rel="noopener noreferrer">THIR</a> version).</p><p>For example, for the first parameter <code>self</code>, named <code>Œ±4</code> in this translation, we do:</p><div class="codeBlockContainer_K1bP language-coq theme-code-block"><div class="codeBlockContent_hGly coq"><pre tabindex="0" class="prism-code language-coq codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">  let* Œ±0 : ref erc20.Erc20.t := M.read self in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* Œ±1 : M.Val erc20.Erc20.t := deref Œ±0 in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* Œ±2 : ref erc20.Erc20.t := borrow Œ±1 in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* Œ±3 : M.Val (ref erc20.Erc20.t) := M.alloc Œ±2 in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* Œ±4 : ref erc20.Erc20.t := M.read Œ±3 in</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>We combine the operators:</p><ul><li><code>M.read</code>: to get a value of type <code>A</code> from a value with an address <code>M.Val</code>,</li><li><code>deref</code>: to get the value with an address <code>M.Val A</code> pointed by a reference <code>ref A</code>,</li><li><code>borrow</code>: to get the reference <code>ref A</code> to a value with an address <code>M.Val A</code>,</li><li><code>M.alloc</code>: to allocate a new value <code>A</code> in memory, returning a value with address <code>M.Val A</code>.</li></ul><p>We do the same to compute the second parameter <code>&amp;owner</code> of <code>balance_of_impl</code> with:</p><div class="codeBlockContainer_K1bP language-coq theme-code-block"><div class="codeBlockContent_hGly coq"><pre tabindex="0" class="prism-code language-coq codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">  let* Œ±5 : ref erc20.AccountId.t := borrow owner in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* Œ±6 : M.Val (ref erc20.AccountId.t) := M.alloc Œ±5 in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* Œ±7 : ref erc20.AccountId.t := M.read Œ±6 in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* Œ±8 : M.Val erc20.AccountId.t := deref Œ±7 in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* Œ±9 : ref erc20.AccountId.t := borrow Œ±8 in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* Œ±10 : M.Val (ref erc20.AccountId.t) := M.alloc Œ±9 in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* Œ±11 : ref erc20.AccountId.t := M.read Œ±10 in</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Finally, we call the <code>balance_of_impl</code> function and return the result:</p><div class="codeBlockContainer_K1bP language-coq theme-code-block"><div class="codeBlockContent_hGly coq"><pre tabindex="0" class="prism-code language-coq codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">  let* Œ±12 : u128.t := erc20.Erc20.t::[&quot;balance_of_impl&quot;] Œ±4 Œ±11 in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* Œ±13 : M.Val u128.t := M.alloc Œ±12 in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  M.read Œ±13.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>We do not keep the address of the result, as it will be allocated again by the caller function.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="optimizations">Optimizations<a class="hash-link" href="#optimizations" title="Direct link to heading">‚Äã</a></h2><p>Some operations can always be removed, namely:</p><ul><li><code>M.read (M.alloc v) ==&gt; v</code>: we do not need to allocate and give an address to a value if it will be immediately read,</li><li><code>deref (borrow v) ==&gt; v</code> and <code>borrow (deref v) ==&gt; v</code>: the borrowing and dereferencing operators are doing the opposite, so they cancel each other. We need to be careful of the mutability status of the borrowing and dereferencing.</li></ul><p>Applying these simple simplification rules, we get the following slimed-down translation:</p><div class="codeBlockContainer_K1bP language-coq theme-code-block"><div class="codeBlockContent_hGly coq"><pre tabindex="0" class="prism-code language-coq codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">Definition balance_of</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (self : ref ltac:(Self))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (owner : erc20.AccountId.t)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    : M ltac:(erc20.Balance) :=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* self : M.Val (ref ltac:(Self)) := M.alloc self in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* owner : M.Val erc20.AccountId.t := M.alloc owner in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* Œ±0 : ref erc20.Erc20.t := M.read self in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let* Œ±1 : ref erc20.AccountId.t := borrow owner in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  erc20.Erc20.t::[&quot;balance_of_impl&quot;] Œ±0 Œ±1.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This is much shorter and easier to verify!</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="conclusion">Conclusion<a class="hash-link" href="#conclusion" title="Direct link to heading">‚Äã</a></h2><p>We have illustrated in an example how we translate a simple function from Rust to Coq. In this example, we saw how the pointer operations are made explicit in the abstract syntax tree of Rust, and how we simplify them for the frequent cases.</p><p>If you have any comments or suggestions, feel free to email us at<!-- -->¬†<a href="mailto:contact@formal.land" target="_blank" rel="noopener noreferrer">c<!-- -->o<!-- -->n<!-- -->t<!-- -->a<!-- -->c<!-- -->t<!-- -->@<!-- -->formal<!-- -->.<!-- -->l<!-- -->a<!-- -->n<!-- -->d</a>. In future posts, we will go into more detail about the verification process itself.</p></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_3kfx"><div class="col"><b>Tags:</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/blog/tags/coq-of-rust">coq-of-rust</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/blog/tags/rust">Rust</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/blog/tags/coq">Coq</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2023/12/13/rust-verify-erc-20-smart-contract"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">¬´ <!-- -->Verifying an ERC-20 smart contract in Rust</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2023/11/08/rust-thir-and-bundled-traits"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Optimizing Rust translation to Coq with THIR and bundled traits<!-- --> ¬ª</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#translating-a-function-body" class="table-of-contents__link toc-highlight">Translating a function body</a></li><li><a href="#optimizations" class="table-of-contents__link toc-highlight">Optimizations</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Content</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/company/about">Company</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/company/claims">Claims</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/company/press">Press</a></li></ul></div><div class="col footer__col"><div class="footer__title">Links</div><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/LandFoobar" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://fr.linkedin.com/company/formal-land" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Linkedin<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://t.me/formal_land" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.tiktok.com/@formal.land" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>TikTok<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="mailto:contact@formal.land" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Email<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/formal-land" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://gitlab.com/formal-land" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitLab<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://formal-land.gitlab.io/coq-tezos-of-ocaml/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Coq Tezos of OCaml<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2024 Formal Land (Arae SARL) üê¶, Paris<br><em>Formal verification for everyday-life applications üèá</em><!-- Start of LiveChat (www.livechat.com) code -->
<script>window.__lc=window.__lc||{},window.__lc.license=14938650,function(n,t,c){function i(n){return e._h?e._h.apply(null,n):e._q.push(n)}var e={_q:[],_h:null,_v:"2.0",on:function(){i(["on",c.call(arguments)])},once:function(){i(["once",c.call(arguments)])},off:function(){i(["off",c.call(arguments)])},get:function(){if(!e._h)throw new Error("[LiveChatWidget] You can't use getters before load.");return i(["get",c.call(arguments)])},call:function(){i(["call",c.call(arguments)])},init:function(){var n=t.createElement("script");n.async=!0,n.type="text/javascript",n.src="https://cdn.livechatinc.com/tracking.js",t.head.appendChild(n)}};!n.__lc.asyncInit&&e.init(),n.LiveChatWidget=n.LiveChatWidget||e}(window,document,[].slice)</script>
<noscript><a href="https://www.livechat.com/chat-with/14938650/" rel="nofollow">Chat with us</a>, powered by <a href="https://www.livechat.com/?welcome" rel="noopener nofollow" target="_blank">LiveChat</a></noscript>
<!-- End of LiveChat code --></div></div></div></footer></div>
<script src="/assets/js/runtime~main.182d6f7c.js"></script>
<script src="/assets/js/main.d84506b2.js"></script>
</body>
</html>