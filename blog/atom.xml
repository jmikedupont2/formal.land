<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://formal.land/blog</id>
    <title>Formal Land Blog</title>
    <updated>2022-02-02T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://formal.land/blog"/>
    <subtitle>Formal Land Blog</subtitle>
    <icon>https://formal.land/img/land-512.png</icon>
    <entry>
        <title type="html"><![CDATA[Make Tezos the first formally verified cryptocurrency]]></title>
        <id>/2022/02/02/make-tezos-a-formally-verified-crypto</id>
        <link href="https://formal.land/blog/2022/02/02/make-tezos-a-formally-verified-crypto"/>
        <updated>2022-02-02T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Elephants]]></summary>
        <content type="html"><![CDATA[<p><img src="elephants-elmira-gokoryan.webp" alt="Elephants"/></p><p>Our primary goal at <a href="https://formal.land/">Formal<!-- -->Â <!-- -->Land<!-- -->Â <!-- -->ðŸŒ²</a> is to make <a href="https://tezos.com/">Tezos</a> the first crypto-currency with a formally verified implementation. With <a href="https://en.wikipedia.org/wiki/Formal_verification">formal verification</a>, thanks to mathematical methods, we can check that a program behaves as expected for all possible inputs. Formal verification goes beyond what testing can do, as testing can only handle a finite amount of cases. That is critical as cryptocurrencies hold a large amount of money (around $3B for Tezos today). The current result of our verification project is available on <a href="https://nomadic-labs.gitlab.io/coq-tezos-of-ocaml/">nomadic-labs.gitlab.io/coq-tezos-of-ocaml</a>. Formal verification is also key to allowing Tezos to evolve constantly in a safe and backward compatible manner.</p><p>We proceed in two steps:</p><ol><li>we translate the code of Tezos, written in <a href="https://ocaml.org/">OCaml</a>, to the proof language <a href="https://coq.inria.fr/">Coq</a> using the translator <a href="https://github.com/foobar-land/coq-of-ocaml">coq-of-ocaml</a>;</li><li>we write our specifications and proofs in the Coq language.</li></ol><p>We believe this is one of the most efficient ways to proceed, as we can work on an almost unmodified version of the codebase and use the full power of the mature proof system Coq. The code of Tezos is composed of around:</p><ul><li>50,000 lines for the protocol (the kernel of Tezos), and</li><li>200,000 lines for the shell (everything else, including the peer-to-peer layer and the storage backend).</li></ul><p>We are currently focusing on verifying the protocol for the following modules.</p><h2>Data-encoding</h2><p>The <a href="https://gitlab.com/nomadic-labs/data-encoding">data-encoding</a> library offers serialization and deserialization to binary and JSON formats. It is used in various parts of the Tezos protocol, especially on all the data types ending up in the storage system. In practice, many encodings are defined in the OCaml files named <code>*_repr.ml</code>. We verify that the <code>data-encoding</code> library is correctly used to define the encodings. We check that converting a value to binary format and from binary returns the initial value. We explicit the domain of validity of such conversions. This verification work generally reveals and propagates invariants about the data structures of the protocol. As an invariant example, all the account amounts should always be positive. Having these invariants will be helpful for the verification of higher-level layers of the protocol.</p><h2>Michelson smart contracts</h2><p>The smart contract language of Tezos is <a href="https://tezos.gitlab.io/active/michelson.html">Michelson</a>. The interpreter and type-checker of smart contracts is one of the most complex and critical parts of the protocol. We are verifying two things about this code:</p><ul><li>The equivalence of the interpreter and the Coq semantics for Michelson defined in the project <a href="https://gitlab.com/nomadic-labs/mi-cho-coq">Mi-Cho-Coq</a>. Thanks to this equivalence, we can make sure that the formal verification of smart contracts is sound for the current version of the protocol.</li><li>The compatibility of the parsing and unparsing functions for the Michelson types and values. The parsing functions take care of the type-checking and do a lot of sanity checks on Michelson expressions with appropriate error messages. Showing that the parsing and unparsing functions are inverses is important for security reasons. The Michelson values are always unparsed at the end of a smart contract execution to be stored on disk.</li></ul><p>To do these proofs, we also give a new semantics of Michelson, expressed using dependent types rather than <a href="https://ocaml.org/manual/gadts-tutorial.html">GADTs</a> in the OCaml implementation.</p><h2>Storage system</h2><p>Cryptocurrencies typically take a lot of space on disk (in the hundreds of gigabytes). In Tezos, we use the key-value database <a href="https://irmin.org/">Irmin</a>. The protocol provides a lot of <a href="https://gitlab.com/tezos/tezos/-/blob/master/src/proto_alpha/lib_protocol/storage_functors.ml">abstractions</a> over this database to expose higher-level interfaces with set and map-like APIs. We verify that these abstractions are valid doing a proof by simulation, where we show that the whole system is equivalent to an <a href="https://en.wikipedia.org/wiki/In-memory_database">in-memory database</a> using simpler data structures. Thanks to this simulation, we will be able to reason about code using the storage as if we were using the simpler in-memory version.</p><h2>In addition</h2><p>We also plan to verify:</p><ul><li>The implementation of the <code>data-encoding</code> library itself. This code is challenging for formal verification as it contains many imperative features. Another specificity of this library is that it sits outside of the protocol of Tezos, and we might need to adapt <code>coq-of-ocaml</code> to support it.</li><li>The <a href="https://gitlab.com/tezos/tezos/-/tree/master/src/proto_alpha/lib_protocol/test/pbt">property-based tests of the protocol</a>. These tests are written as boolean functions (or functions raising exceptions), which must return <code>true</code> on any possible inputs. We will verify them in the general case by importing their definitions to Coq and verifying with mathematical proofs that they are always correct.</li></ul><p>:::tip Contact
For any questions or remarks, contact us on ðŸ‘‰<!-- -->Â <a href="mailto:contact@formal.land">c<!-- -->o<!-- -->n<!-- -->t<!-- -->a<!-- -->c<!-- -->t<!-- -->@<!-- -->formal<!-- -->.<!-- -->l<!-- -->a<!-- -->n<!-- -->d</a>Â <!-- -->ðŸ‘ˆ.
:::</p>]]></content>
        <author>
            <name>Guillaume Claret</name>
            <uri>https://github.com/clarus</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[New blog posts and Meetup talk]]></title>
        <id>/2021/11/12/new-blog-posts-and-meetup-talk</id>
        <link href="https://formal.land/blog/2021/11/12/new-blog-posts-and-meetup-talk"/>
        <updated>2021-11-12T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Recently, we added two new blog posts about the verification of the crypto-currency Tezos:]]></summary>
        <content type="html"><![CDATA[<p>Recently, we added two new blog posts about the verification of the crypto-currency <a href="https://tezos.com/">Tezos</a>:</p><ul><li><a href="https://nomadic-labs.gitlab.io/coq-tezos-of-ocaml/blog/2021/11/01/verify-michelson-types-mi-cho-coq/">Verify the Michelson types of Mi-Cho-Coq</a> to compare the types defined in the Tezos code for the <a href="http://tezos.gitlab.io/active/michelson.html">Michelson</a> interpreter and in the <a href="https://gitlab.com/nomadic-labs/mi-cho-coq">Mi-Cho-Coq library</a> to verify smart contracts;</li><li><a href="https://nomadic-labs.gitlab.io/coq-tezos-of-ocaml/blog/2021/11/08/translate-tenderbake/">Translate the Tenderbake&#x27;s code to Coq</a> to explain how we translated the recent changes in Tezos to the Coq using <a href="https://github.com/foobar-land/coq-of-ocaml">coq-of-ocaml</a>. In particular we translated the code of the new <a href="https://research-development.nomadic-labs.com/a-look-ahead-to-tenderbake.html">Tenderbake</a> consensus algorithm.</li></ul><p>We also talked at the <a href="https://www.meetup.com/LambdaLille/events/281374644/">Lambda Lille Meetup</a> (in French) to present our work on <code>coq-of-ocaml</code> for Tezos. A video on the <a href="https://www.youtube.com/channel/UC-hC7y_ilQBq0QCa9xDu1iA">Youtube channel</a> of the Meetup should be available shortly. We thanks the organizers for hosting the talk.</p>]]></content>
        <author>
            <name>Guillaume Claret</name>
            <uri>https://github.com/clarus</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[Verification of the use of data-encoding]]></title>
        <id>/2021/10/27/verification-data-encoding</id>
        <link href="https://formal.land/blog/2021/10/27/verification-data-encoding"/>
        <updated>2021-10-27T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[We added a blog post about the verification of the use of data-encodings in the protocol of Tezos. Currently, we work on the verification of Tezos and publish our blog articles there. We use coq-of-ocaml to translate the OCaml code to Coq and do our verification effort.]]></summary>
        <content type="html"><![CDATA[<p>We added a blog post about the <a href="https://nomadic-labs.gitlab.io/coq-tezos-of-ocaml/blog/2021/10/20/data-encoding-usage">verification of the use of data-encodings</a> in the protocol of Tezos. Currently, we work on the verification of Tezos and publish our blog articles there. We use <a href="https://foobar-land.github.io/coq-of-ocaml/">coq-of-ocaml</a> to translate the OCaml code to Coq and do our verification effort.</p>]]></content>
        <author>
            <name>Guillaume Claret</name>
            <uri>https://github.com/clarus</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[Welcome]]></title>
        <id>/2021/10/10/welcome</id>
        <link href="https://formal.land/blog/2021/10/10/welcome"/>
        <updated>2021-10-10T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Welcome to the blog of Formal Land. Here we will post various updates about the work we are doing.]]></summary>
        <content type="html"><![CDATA[<p>Welcome to the blog of <a href="/">Formal Land</a>. Here we will post various updates about the work we are doing.</p>]]></content>
        <author>
            <name>Guillaume Claret</name>
            <uri>https://github.com/clarus</uri>
        </author>
    </entry>
</feed>